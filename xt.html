<script>
    const chatBox = document.getElementById('chat-box');
    const inputField = document.getElementById('user-input');

    async function sendMessage() {
        const text = inputField.value;
        if (!text) return;

        addMessage(text, 'user');
        inputField.value = '';

        // Menampilkan status "AI sedang berpikir..."
        const loadingDiv = document.createElement('div');
        loadingDiv.className = 'msg ai';
        loadingDiv.innerText = 'Bentar Bang, lagi mikir...';
        chatBox.appendChild(loadingDiv);

        try {
            // Menghubungkan ke Otak AI (Model GPT-2 atau sejenisnya yang gratis)
            const response = await fetch("https://api-inference.huggingface.co/models/facebook/blenderbot-400M-distill", {
                headers: { "Content-Type": "application/json" },
                method: "POST",
                body: JSON.stringify({ inputs: text }),
            });
            const result = await response.json();
            
            chatBox.removeChild(loadingDiv); // Hapus tulisan loading
            const aiReply = result[0].generated_text || "Maaf Bang, otak saya lagi hang. Coba tanya lagi!";
            
            addMessage(aiReply, 'ai');
            speak(aiReply); // AI bersuara
        } catch (error) {
            chatBox.removeChild(loadingDiv);
            addMessage("Waduh, koneksi internetnya bermasalah nih Bang.", "ai");
        }
    }

    function addMessage(text, sender) {
        const div = document.createElement('div');
        div.className = `msg ${sender}`;
        div.innerText = text;
        chatBox.appendChild(div);
        chatBox.scrollTop = chatBox.scrollHeight;
    }

    function speak(text) {
        const msg = new SpeechSynthesisUtterance();
        msg.text = text;
        msg.lang = 'id-ID'; 
        window.speechSynthesis.speak(msg);
    }
</script>
